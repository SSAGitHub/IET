buildscript {
	repositories {
		mavenCentral()

		maven {
			url "http://nexus.theiet.org/nexus/content/groups/public"
			credentials {
				username ietMavenUser
				password ietMavenPassword
			}
		}

	}
	dependencies { classpath 'com.rsicms:rsuite-projects-deploy-gradle-plugin:0.0.8' }
}


apply plugin: 'com.rsicms.rsuite.projects.deploy'
apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'groovy'


// this is for the deploy.gradle 
repositories {
	
	maven {
		url "http://nexus.theiet.org/nexus/content/groups/public"
		credentials {
			username ietMavenUser
			password ietMavenPassword
		}
	}
}
	
dependencies {
	rsuiteGroovy 'rsi:rsuite-admin-client-extension:0.1.2'
}


rsuiteDeployment{

  //  setDefaultPropertyValue("inspecBaseHotfolderPath", "")
	// setDefaultPropertyValue("inspecClear", "false")

	rsuiteGroovy{
	
		common 'BooksDeployAll.groovy'
		common 'JournalsDeployAll.groovy'
	//	common 'DeployRSuitePluginsIET.groovy' -- This script is not needed 
		common "StandardsLoadDitaDtds.groovy;-Dditaot=${ditaotdir}"
		common 'StandardsConfigureRoles.groovy'
		common 'StandardsCaTypes.groovy'
		common 'StandardsConfigureRoles.groovy'
		common 'StandardsLayeredMetadata.groovy'
		common 'StandardsCreateBrowseStructure.groovy'
		common "StandardsCreateHotFolder.groovy;-DbaseDir=${rSuiteHotfoldersDir}"
		common "StandardsLoadInitialContent.groovy;-DhotfoldersBasePath=${rSuiteHotfoldersDir}"
		common 'OnixConfigureRoles.groovy'
		common 'OnixSchemas.groovy'
		common 'OnixLayeredMetadata.groovy'
		common 'OnixCaTypes.groovy'
		common 'OnixCreateBrowseStructure.groovy'
		common 'OnixLoadInitialContent.groovy'
		common 'IETtvLayeredMetadata.groovy'
		common 'IETtvSchemas.groovy'
		common 'IETtvCaTypes.groovy'
		common 'IETtvConfigureRoles.groovy'
		common 'IETtvCreateBrowseStructure.groovy'
		common "IETtvCreateHotFolder.groovy;-DbaseDir=${rSuiteHotfoldersDir}"
		
		development "CreateHotFolder.groovy;-DbaseDir=${rSuiteHotfoldersDir}"
		development 'ConfigureLocalUsers.groovy'
		development 'JournalConfigureLocalUsers.groovy'
		development 'StandardsConfigureLocalUsers.groovy'
		development 'OnixConfigureLocalUsers.groovy'
		development 'IETtvConfigureDevelopmentLocalUsers.groovy'
	}

	rsuitePlugins{ 
		plugin 'com.rsicms:rsuite-lmd-editor-plugin:4.0.0.qa161_v1_20130927'
		plugin 'com.rsicms:rsuite-zip-uploader-plugin:1.1'
        plugin 'com.rsicms:rsuite-zip-downloader-plugin:1.1'
        plugin 'com.rsicms:rsuite-dita-support-plugin:1.2-qa1'
        plugin 'com.rsicms.dita4publishers:dita4publishers-rsuite-plugin:0.9.19RC12Issue139'
        plugin 'com.rsicms.oxygen:rsuite-oxygen-applet-integration-plugin:RS4.0.7_oxy15.2-v1.5.15qa7.1'
        plugin 'com.rsicms.oxygen.frameworks:rsuite-o2-framework-dita-plugin:4.0.7_oxy_15.2_o2_plugin_v1.5.15qa1.1'
        plugin 'com.rsicms.oxygen.frameworks:rsuite-o2-framework-onix-plugin:4.0.0_oxy_14.2_v1.0.1'
        plugin 'com.rsicms.oxygen.frameworks:rsuite-o2-framework-jats-plugin:4.0.16_oxy_15.2_v1.1.1'
    }
			 
}


def modulesHome = "${project.ext.get('rsuite.home')}/modules_1_0"

if (project.hasProperty("rsuite.modules.home"))
  modulesHome = "${project.ext.get('rsuite.modules.home')}"

println "Modules home: " + modulesHome
  
task('removeCustomXqueryModules', type: Delete){
  delete fileTree(modulesHome) {
    include '**/iet-*.xqy'
  }
}

task('deployXqueryModules', type: Copy) {
  from('setup/xquery_modules') {
    include '**/*'
  }
  into(modulesHome)
}


tasks.deployXqueryModules.dependsOn(removeCustomXqueryModules)
tasks.deployRSuitePlugins.dependsOn(deployXqueryModules)
tasks.developmentDeployPluginJarOnly.dependsOn(deployXqueryModules)
